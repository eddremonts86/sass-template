# Internationalization (i18n) Guide

Complete guide to implementing multi-language support with next-intl.

## Overview

This template uses **next-intl** for internationalization with support for:

- English (en) - default
- Spanish (es)
- Danish (da)

## Configuration

### next-intl Setup

```typescript
// src/lib/i18n/config.ts
export const locales = ['en', 'es', 'da'] as const;
export type Locale = (typeof locales)[number];

export const defaultLocale: Locale = 'en';

export const localeNames: Record<Locale, string> = {
  en: 'English',
  es: 'Español',
  da: 'Dansk',
};
```

### Routing

The template uses locale-based routing with the `[locale]` dynamic segment:

```
src/app/
  [locale]/
    layout.tsx           # Locale layout
    page.tsx            # Home page
    dashboard/          # Dashboard pages
    about/              # About pages
```

URLs:

- `/en/dashboard` - English
- `/es/dashboard` - Spanish
- `/da/dashboard` - Danish

### Middleware

```typescript
// src/middleware.ts
import createMiddleware from 'next-intl/middleware';
import { locales, defaultLocale } from '@/lib/i18n/config';

export default createMiddleware({
  locales,
  defaultLocale,
  localePrefix: 'always', // Always show locale in URL
});

export const config = {
  matcher: ['/((?!api|_next|.*\\..*).*)'],
};
```

## Translation Files

### Structure

```
src/lib/i18n/locales/
  en.json              # English translations
  es.json              # Spanish translations
  da.json              # Danish translations
```

### Translation Format

```json
// en.json
{
  "common": {
    "welcome": "Welcome",
    "logout": "Log out",
    "loading": "Loading..."
  },
  "navigation": {
    "home": "Home",
    "about": "About",
    "contact": "Contact"
  },
  "dashboard": {
    "title": "Dashboard",
    "overview": "Overview",
    "stats": {
      "users": "Total Users",
      "revenue": "Revenue"
    }
  },
  "errors": {
    "notFound": "Page not found",
    "serverError": "Server error"
  }
}
```

```json
// es.json
{
  "common": {
    "welcome": "Bienvenido",
    "logout": "Cerrar sesión",
    "loading": "Cargando..."
  },
  "navigation": {
    "home": "Inicio",
    "about": "Acerca de",
    "contact": "Contacto"
  },
  "dashboard": {
    "title": "Panel",
    "overview": "Resumen",
    "stats": {
      "users": "Usuarios Totales",
      "revenue": "Ingresos"
    }
  },
  "errors": {
    "notFound": "Página no encontrada",
    "serverError": "Error del servidor"
  }
}
```

## Usage

### Server Components

```tsx
import { getTranslations } from 'next-intl/server';

export default async function HomePage() {
  const t = await getTranslations('common');

  return (
    <div>
      <h1>{t('welcome')}</h1>
    </div>
  );
}
```

### Client Components

```tsx
'use client';

import { useTranslations } from 'next-intl';

export function Welcome() {
  const t = useTranslations('common');

  return <h1>{t('welcome')}</h1>;
}
```

### With Parameters

```json
{
  "greeting": "Hello, {name}!",
  "itemCount": "You have {count} {count, plural, one {item} other {items}}"
}
```

```tsx
const t = useTranslations('common')

<p>{t('greeting', { name: 'John' })}</p>
// Output: Hello, John!

<p>{t('itemCount', { count: 1 })}</p>
// Output: You have 1 item

<p>{t('itemCount', { count: 5 })}</p>
// Output: You have 5 items
```

### Nested Keys

```tsx
const t = useTranslations('dashboard.stats')

<div>
  <h2>{t('users')}</h2>
  <h2>{t('revenue')}</h2>
</div>
```

## Locale Switching

### Locale Selector Component

```tsx
'use client';

import { useParams, useRouter, usePathname } from 'next/navigation';
import { locales, localeNames } from '@/lib/i18n/config';
import type { Locale } from '@/lib/i18n/config';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';

export function LocaleSelector() {
  const params = useParams();
  const router = useRouter();
  const pathname = usePathname();

  const currentLocale = params.locale as Locale;

  const handleLocaleChange = (newLocale: string) => {
    const newPathname = pathname.replace(`/${currentLocale}`, `/${newLocale}`);
    router.push(newPathname);
  };

  return (
    <Select value={currentLocale} onValueChange={handleLocaleChange}>
      <SelectTrigger className="w-32">
        <SelectValue />
      </SelectTrigger>
      <SelectContent>
        {locales.map(locale => (
          <SelectItem key={locale} value={locale}>
            {localeNames[locale]}
          </SelectItem>
        ))}
      </SelectContent>
    </Select>
  );
}
```

### Persisting Locale Preference

```tsx
// Store locale in Zustand
import { useAuthStore } from '@/stores/auth-store';

export function LocaleSelector() {
  const { locale, setLocale } = useAuthStore();
  const router = useRouter();
  const pathname = usePathname();

  const handleLocaleChange = (newLocale: Locale) => {
    setLocale(newLocale);
    const newPathname = pathname.replace(`/${locale}`, `/${newLocale}`);
    router.push(newPathname);
  };

  return (
    <Select value={locale} onValueChange={handleLocaleChange}>
      {/* ... */}
    </Select>
  );
}
```

## Translation Management

### Checking Completeness

```bash
pnpm check:translations
```

This script verifies all locales have the same keys.

### Syncing Missing Keys

```bash
pnpm sync:translations
```

Adds missing keys from the default locale (English) to other locales.

### Adding New Translations

1. Add key to `src/lib/i18n/locales/en.json`
2. Run `pnpm sync:translations`
3. Update translated values in `es.json` and `da.json`

## Advanced Features

### Date Formatting

```tsx
import { useFormatter } from 'next-intl';

export function DateDisplay({ date }: { date: Date }) {
  const format = useFormatter();

  return (
    <time>
      {format.dateTime(date, {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
      })}
    </time>
  );
}
```

### Number Formatting

```tsx
const format = useFormatter()

<p>{format.number(1234.56, { style: 'currency', currency: 'USD' })}</p>
// Output: $1,234.56

<p>{format.number(0.5, { style: 'percent' })}</p>
// Output: 50%
```

### Relative Time

```tsx
const format = useFormatter()
const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000)

<p>{format.relativeTime(yesterday)}</p>
// Output: yesterday (in English) / ayer (in Spanish)
```

### List Formatting

```tsx
const format = useFormatter()
const items = ['Apple', 'Banana', 'Cherry']

<p>{format.list(items, { type: 'conjunction' })}</p>
// Output: Apple, Banana, and Cherry

<p>{format.list(items, { type: 'disjunction' })}</p>
// Output: Apple, Banana, or Cherry
```

## SEO Considerations

### Locale-Specific Metadata

```tsx
import { getTranslations } from 'next-intl/server';

export async function generateMetadata({
  params,
}: {
  params: { locale: string };
}) {
  const t = await getTranslations({
    locale: params.locale,
    namespace: 'metadata',
  });

  return {
    title: t('title'),
    description: t('description'),
  };
}
```

### Alternate Language Links

```tsx
export async function generateMetadata({
  params,
}: {
  params: { locale: string };
}) {
  return {
    alternates: {
      canonical: `https://example.com/${params.locale}`,
      languages: {
        en: 'https://example.com/en',
        es: 'https://example.com/es',
        da: 'https://example.com/da',
      },
    },
  };
}
```

## Best Practices

1. **Use namespaces** - Organize translations by feature/page
2. **Avoid hardcoded strings** - All user-facing text should be translated
3. **Keep keys semantic** - Use descriptive key names
4. **Provide context** - Use comments in JSON for translators
5. **Test all locales** - Verify UI works with different string lengths
6. **Use placeholders** - For dynamic content like names, dates, counts
7. **Maintain consistency** - Use same terms across the app

## Common Patterns

### Form Labels

```json
{
  "forms": {
    "login": {
      "email": "Email address",
      "password": "Password",
      "submit": "Sign in",
      "forgotPassword": "Forgot password?"
    }
  }
}
```

### Error Messages

```json
{
  "errors": {
    "required": "This field is required",
    "invalidEmail": "Please enter a valid email",
    "minLength": "Must be at least {min} characters",
    "maxLength": "Must be at most {max} characters"
  }
}
```

### Navigation

```json
{
  "nav": {
    "main": {
      "home": "Home",
      "about": "About",
      "contact": "Contact"
    },
    "footer": {
      "privacy": "Privacy Policy",
      "terms": "Terms of Service"
    }
  }
}
```
